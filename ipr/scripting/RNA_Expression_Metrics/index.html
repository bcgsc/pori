
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>RNA Expression Metrics - PORI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../styles.css">
    
      <link rel="stylesheet" href="../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#calculating-expression-outliers-against-a-reference-data-set" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="PORI" class="md-header__button md-logo" aria-label="PORI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PORI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              RNA Expression Metrics
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bcgsc/pori/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="PORI" class="md-nav__button md-logo" aria-label="PORI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    PORI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bcgsc/pori/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../demo/" class="md-nav__link">
        Demo
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        Install with Docker
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../repos/" class="md-nav__link">
        All PORI Repositories
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          GraphKB
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="GraphKB" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          GraphKB
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/" class="md-nav__link">
        About GraphKB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/loading_data/" class="md-nav__link">
        Loading Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          How Matching Works
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How Matching Works" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          How Matching Works
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/matching/" class="md-nav__link">
        Ontology Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/matching/gene/" class="md-nav__link">
        Gene Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" type="checkbox" id="__nav_6_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Scripting Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Scripting Examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Scripting Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/scripting/" class="md-nav__link">
        About the Python Adapter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/scripting/Intro_Tutorial/" class="md-nav__link">
        Introductory Tutorial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/scripting/Query_Basics/" class="md-nav__link">
        Query Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/scripting/Annotate_a_VCF_with_GraphKB/" class="md-nav__link">
        Annotate a VCF with GraphKB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/scripting/snpsift/" class="md-nav__link">
        Annotate SNPSift Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../graphkb/scripting/variant_strings/" class="md-nav__link">
        Annotate Variant List
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          IPR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPR" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          IPR
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        About IPR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../upload/" class="md-nav__link">
        Uploading A Report
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          Core Variant Types
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core Variant Types" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Core Variant Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_variants/" class="md-nav__link">
        About
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_variants/copy/" class="md-nav__link">
        Copy Variants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_variants/expression/" class="md-nav__link">
        Expression Variants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_variants/mutations/" class="md-nav__link">
        Small Mutations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_variants/structural/" class="md-nav__link">
        Structural Variants
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kb_matches/" class="md-nav__link">
        KB Matches
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_5">
          Optional Analyses
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Optional Analyses" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Optional Analyses
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/burden/" class="md-nav__link">
        Mutation Burden
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/circos_plots/" class="md-nav__link">
        Circos Plots
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/comparators/" class="md-nav__link">
        Comparators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/expression_correlation/" class="md-nav__link">
        Expression Correlation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/images/" class="md-nav__link">
        Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/immune/" class="md-nav__link">
        Immune Profiling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/metadata/" class="md-nav__link">
        Patient Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optional_analyses/signature/" class="md-nav__link">
        Mutation Signatures
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../manual_curation/" class="md-nav__link">
        Manual Curation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../templates/" class="md-nav__link">
        Templates
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_8" type="checkbox" id="__nav_7_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7_8">
          Scripting Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Scripting Examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_8">
          <span class="md-nav__icon md-icon"></span>
          Scripting Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          RNA Expression Metrics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        RNA Expression Metrics
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#download-the-data" class="md-nav__link">
    Download the Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-dependencies" class="md-nav__link">
    Install Dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-the-disease-matrix-subset" class="md-nav__link">
    Create the Disease Matrix Subset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculating-metrics" class="md-nav__link">
    Calculating Metrics
  </a>
  
    <nav class="md-nav" aria-label="Calculating Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#percentile" class="md-nav__link">
    Percentile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculating-kiqr" class="md-nav__link">
    Calculating kIQR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-report-input" class="md-nav__link">
    Creating the Report Input
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../RNA_Expression_Similarity/" class="md-nav__link">
        RNA Expression Similarity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Variant Notation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Variant Notation" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Variant Notation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../variant_notation/" class="md-nav__link">
        About Variant Notation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../variant_notation/continuous/" class="md-nav__link">
        Continuous Notation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../variant_notation/split/" class="md-nav__link">
        Multi-Feature (Split) Notation
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_4" type="checkbox" id="__nav_8_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_4">
          Coordinate Systems
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Coordinate Systems" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_4">
          <span class="md-nav__icon md-icon"></span>
          Coordinate Systems
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../variant_notation/coordinate_systems/" class="md-nav__link">
        About
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../variant_notation/coordinate_systems/cytoband/" class="md-nav__link">
        CytoBand Coordinates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Developer Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developer Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Developer Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/" class="md-nav__link">
        About the Developer Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/contributing/" class="md-nav__link">
        Contributing Guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_4" type="checkbox" id="__nav_9_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_4">
          Graphkb
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Graphkb" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_4">
          <span class="md-nav__icon md-icon"></span>
          Graphkb
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/graphkb/__init__/" class="md-nav__link">
        graphkb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/graphkb/genes/" class="md-nav__link">
        graphkb.genes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/graphkb/match/" class="md-nav__link">
        graphkb.match
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/graphkb/statement/" class="md-nav__link">
        graphkb.statement
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/graphkb/types/" class="md-nav__link">
        graphkb.types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/graphkb/util/" class="md-nav__link">
        graphkb.util
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/graphkb/vocab/" class="md-nav__link">
        graphkb.vocab
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_5" type="checkbox" id="__nav_9_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_5">
          Ipr
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Ipr" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_5">
          <span class="md-nav__icon md-icon"></span>
          Ipr
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/annotate/" class="md-nav__link">
        ipr.annotate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/connection/" class="md-nav__link">
        ipr.connection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/inputs/" class="md-nav__link">
        ipr.inputs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/ipr/" class="md-nav__link">
        ipr.ipr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/main/" class="md-nav__link">
        ipr.main
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/summary/" class="md-nav__link">
        ipr.summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/therapeutic_options/" class="md-nav__link">
        ipr.therapeutic_options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/types/" class="md-nav__link">
        ipr.types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer_reference/ipr/util/" class="md-nav__link">
        ipr.util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/bcgsc/pori/edit/master/docs/ipr/scripting/RNA_Expression_Metrics.ipynb" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="calculating-expression-outliers-against-a-reference-data-set">Calculating Expression Outliers Against a Reference Data Set<a class="headerlink" href="#calculating-expression-outliers-against-a-reference-data-set" title="Permanent link">&para;</a></h1>
<p><a href="https://colab.research.google.com/github/bcgsc/pori/blob/feature%2Fcolab-notebooks/docs/ipr/scripting/RNA_Expression_Metrics.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<h2 id="download-the-data">Download the Data<a class="headerlink" href="#download-the-data" title="Permanent link">&para;</a></h2>
<p>First we need to download the data set we will use. We are going to use the TCGA data here since it is publically available and well known (<a href="https://xenabrowser.net/datapages/?cohort=TCGA%20Pan-Cancer%20(PANCAN)">UCSC Xena TCGA PANCAN</a>). We will download the TPM matrix as well as the corresponding metadata file</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">toil</span><span class="o">-</span><span class="n">xena</span><span class="o">-</span><span class="n">hub</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">tcga_RSEM_gene_tpm</span><span class="o">.</span><span class="n">gz</span>
<span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">tcga</span><span class="o">-</span><span class="n">pancan</span><span class="o">-</span><span class="n">atlas</span><span class="o">-</span><span class="n">hub</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">Survival_SupplementalTable_S1_20171025_xena_sp</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>--2021-06-09 19:24:14--  https://toil-xena-hub.s3.us-east-1.amazonaws.com/download/tcga_RSEM_gene_tpm.gz
Resolving toil-xena-hub.s3.us-east-1.amazonaws.com (toil-xena-hub.s3.us-east-1.amazonaws.com)... 52.216.80.45
Connecting to toil-xena-hub.s3.us-east-1.amazonaws.com (toil-xena-hub.s3.us-east-1.amazonaws.com)|52.216.80.45|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 740772247 (706M) [binary/octet-stream]
Saving to: ‘tcga_RSEM_gene_tpm.gz.1’

tcga_RSEM_gene_tpm. 100%[===================&gt;] 706.46M  25.4MB/s    in 24s     

2021-06-09 19:24:38 (30.0 MB/s) - ‘tcga_RSEM_gene_tpm.gz.1’ saved [740772247/740772247]

--2021-06-09 19:24:38--  https://tcga-pancan-atlas-hub.s3.us-east-1.amazonaws.com/download/Survival_SupplementalTable_S1_20171025_xena_sp
Resolving tcga-pancan-atlas-hub.s3.us-east-1.amazonaws.com (tcga-pancan-atlas-hub.s3.us-east-1.amazonaws.com)... 52.217.93.16
Connecting to tcga-pancan-atlas-hub.s3.us-east-1.amazonaws.com (tcga-pancan-atlas-hub.s3.us-east-1.amazonaws.com)|52.217.93.16|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2419504 (2.3M) [binary/octet-stream]
Saving to: ‘Survival_SupplementalTable_S1_20171025_xena_sp.1’

Survival_Supplement 100%[===================&gt;]   2.31M  7.80MB/s    in 0.3s    

2021-06-09 19:24:38 (7.80 MB/s) - ‘Survival_SupplementalTable_S1_20171025_xena_sp.1’ saved [2419504/2419504]

</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The matrix we have downloaded is very large as it contains many different disease cohorts. For the purposes of this tutorial we want a smaller data set so we are going to choose the smallest TCGA cohort, CHOL. To do this we need to use the metadata file to subset the main matrix file</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="install-dependencies">Install Dependencies<a class="headerlink" href="#install-dependencies" title="Permanent link">&para;</a></h2>
<p>For the following tutorial we are going to use some common data processing and visualization libraries in python: seaborn and pandas. We need to install them before we proceed</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span> <span class="n">seaborn</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (1.1.5)
Requirement already satisfied: seaborn in /usr/local/lib/python3.7/dist-packages (0.11.1)
Requirement already satisfied: numpy&gt;=1.15.4 in /usr/local/lib/python3.7/dist-packages (from pandas) (1.19.5)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas) (2018.9)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas) (2.8.1)
Requirement already satisfied: matplotlib&gt;=2.2 in /usr/local/lib/python3.7/dist-packages (from seaborn) (3.2.2)
Requirement already satisfied: scipy&gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from seaborn) (1.4.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas) (1.15.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=2.2-&gt;seaborn) (1.3.1)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=2.2-&gt;seaborn) (2.4.7)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=2.2-&gt;seaborn) (0.10.0)
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="create-the-disease-matrix-subset">Create the Disease Matrix Subset<a class="headerlink" href="#create-the-disease-matrix-subset" title="Permanent link">&para;</a></h2>
<p>First read the metadata file</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">meta_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Survival_SupplementalTable_S1_20171025_xena_sp&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">meta_df</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample</th>
      <th>_PATIENT</th>
      <th>cancer type abbreviation</th>
      <th>age_at_initial_pathologic_diagnosis</th>
      <th>gender</th>
      <th>race</th>
      <th>ajcc_pathologic_tumor_stage</th>
      <th>clinical_stage</th>
      <th>histological_type</th>
      <th>histological_grade</th>
      <th>initial_pathologic_dx_year</th>
      <th>menopause_status</th>
      <th>birth_days_to</th>
      <th>vital_status</th>
      <th>tumor_status</th>
      <th>last_contact_days_to</th>
      <th>death_days_to</th>
      <th>cause_of_death</th>
      <th>new_tumor_event_type</th>
      <th>new_tumor_event_site</th>
      <th>new_tumor_event_site_other</th>
      <th>new_tumor_event_dx_days_to</th>
      <th>treatment_outcome_first_course</th>
      <th>margin_status</th>
      <th>residual_tumor</th>
      <th>OS</th>
      <th>OS.time</th>
      <th>DSS</th>
      <th>DSS.time</th>
      <th>DFI</th>
      <th>DFI.time</th>
      <th>PFI</th>
      <th>PFI.time</th>
      <th>Redaction</th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>0</th>
      <td>TCGA-OR-A5J1-01</td>
      <td>TCGA-OR-A5J1</td>
      <td>ACC</td>
      <td>58.0</td>
      <td>MALE</td>
      <td>WHITE</td>
      <td>Stage II</td>
      <td>NaN</td>
      <td>Adrenocortical carcinoma- Usual Type</td>
      <td>NaN</td>
      <td>2000.0</td>
      <td>NaN</td>
      <td>-21496.0</td>
      <td>Dead</td>
      <td>WITH TUMOR</td>
      <td>NaN</td>
      <td>1355.0</td>
      <td>NaN</td>
      <td>Distant Metastasis</td>
      <td>Peritoneal Surfaces</td>
      <td>NaN</td>
      <td>754.0</td>
      <td>Complete Remission/Response</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1355.0</td>
      <td>1.0</td>
      <td>1355.0</td>
      <td>1.0</td>
      <td>754.0</td>
      <td>1.0</td>
      <td>754.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TCGA-OR-A5J2-01</td>
      <td>TCGA-OR-A5J2</td>
      <td>ACC</td>
      <td>44.0</td>
      <td>FEMALE</td>
      <td>WHITE</td>
      <td>Stage IV</td>
      <td>NaN</td>
      <td>Adrenocortical carcinoma- Usual Type</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>NaN</td>
      <td>-16090.0</td>
      <td>Dead</td>
      <td>WITH TUMOR</td>
      <td>NaN</td>
      <td>1677.0</td>
      <td>NaN</td>
      <td>Distant Metastasis</td>
      <td>Soft Tissue</td>
      <td>NaN</td>
      <td>289.0</td>
      <td>Progressive Disease</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1677.0</td>
      <td>1.0</td>
      <td>1677.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>289.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TCGA-OR-A5J3-01</td>
      <td>TCGA-OR-A5J3</td>
      <td>ACC</td>
      <td>23.0</td>
      <td>FEMALE</td>
      <td>WHITE</td>
      <td>Stage III</td>
      <td>NaN</td>
      <td>Adrenocortical carcinoma- Usual Type</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>-8624.0</td>
      <td>Alive</td>
      <td>WITH TUMOR</td>
      <td>2091.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Distant Metastasis</td>
      <td>Lung</td>
      <td>NaN</td>
      <td>53.0</td>
      <td>Complete Remission/Response</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>2091.0</td>
      <td>0.0</td>
      <td>2091.0</td>
      <td>1.0</td>
      <td>53.0</td>
      <td>1.0</td>
      <td>53.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>TCGA-OR-A5J4-01</td>
      <td>TCGA-OR-A5J4</td>
      <td>ACC</td>
      <td>23.0</td>
      <td>FEMALE</td>
      <td>WHITE</td>
      <td>Stage IV</td>
      <td>NaN</td>
      <td>Adrenocortical carcinoma- Usual Type</td>
      <td>NaN</td>
      <td>2000.0</td>
      <td>NaN</td>
      <td>-8451.0</td>
      <td>Dead</td>
      <td>WITH TUMOR</td>
      <td>NaN</td>
      <td>423.0</td>
      <td>NaN</td>
      <td>Locoregional Recurrence</td>
      <td>Peritoneal Surfaces</td>
      <td>NaN</td>
      <td>126.0</td>
      <td>Progressive Disease</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>423.0</td>
      <td>1.0</td>
      <td>423.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>126.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TCGA-OR-A5J5-01</td>
      <td>TCGA-OR-A5J5</td>
      <td>ACC</td>
      <td>30.0</td>
      <td>MALE</td>
      <td>WHITE</td>
      <td>Stage III</td>
      <td>NaN</td>
      <td>Adrenocortical carcinoma- Usual Type</td>
      <td>NaN</td>
      <td>2000.0</td>
      <td>NaN</td>
      <td>-11171.0</td>
      <td>Dead</td>
      <td>WITH TUMOR</td>
      <td>NaN</td>
      <td>365.0</td>
      <td>NaN</td>
      <td>Locoregional Recurrence</td>
      <td>Other, specify</td>
      <td>vena cava thrombus</td>
      <td>50.0</td>
      <td>Progressive Disease</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>365.0</td>
      <td>1.0</td>
      <td>365.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>50.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12586</th>
      <td>TCGA-YZ-A980-01</td>
      <td>TCGA-YZ-A980</td>
      <td>UVM</td>
      <td>75.0</td>
      <td>MALE</td>
      <td>WHITE</td>
      <td>Stage IIIA</td>
      <td>Stage IIIA</td>
      <td>Spindle Cell|Epithelioid Cell</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>-27716.0</td>
      <td>Alive</td>
      <td>TUMOR FREE</td>
      <td>1862.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>New Primary Tumor</td>
      <td>Other, specify</td>
      <td>Scalp</td>
      <td>1556.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1862.0</td>
      <td>0.0</td>
      <td>1862.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1556.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12587</th>
      <td>TCGA-YZ-A982-01</td>
      <td>TCGA-YZ-A982</td>
      <td>UVM</td>
      <td>79.0</td>
      <td>FEMALE</td>
      <td>WHITE</td>
      <td>Stage IIIB</td>
      <td>Stage IIIB</td>
      <td>Spindle Cell</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>-28938.0</td>
      <td>Alive</td>
      <td>TUMOR FREE</td>
      <td>495.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>495.0</td>
      <td>0.0</td>
      <td>495.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>495.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12588</th>
      <td>TCGA-YZ-A983-01</td>
      <td>TCGA-YZ-A983</td>
      <td>UVM</td>
      <td>51.0</td>
      <td>FEMALE</td>
      <td>WHITE</td>
      <td>Stage IIB</td>
      <td>Stage IIB</td>
      <td>Epithelioid Cell</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>-18769.0</td>
      <td>Alive</td>
      <td>TUMOR FREE</td>
      <td>798.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>798.0</td>
      <td>0.0</td>
      <td>798.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>798.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12589</th>
      <td>TCGA-YZ-A984-01</td>
      <td>TCGA-YZ-A984</td>
      <td>UVM</td>
      <td>50.0</td>
      <td>FEMALE</td>
      <td>WHITE</td>
      <td>Stage IIB</td>
      <td>Stage IIIA</td>
      <td>Spindle Cell|Epithelioid Cell</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>NaN</td>
      <td>-18342.0</td>
      <td>Dead</td>
      <td>WITH TUMOR</td>
      <td>NaN</td>
      <td>1396.0</td>
      <td>Metastatic Uveal Melanoma</td>
      <td>New Primary Tumor</td>
      <td>Other, specify</td>
      <td>Thyroid</td>
      <td>154.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1396.0</td>
      <td>1.0</td>
      <td>1396.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>154.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12590</th>
      <td>TCGA-YZ-A985-01</td>
      <td>TCGA-YZ-A985</td>
      <td>UVM</td>
      <td>41.0</td>
      <td>FEMALE</td>
      <td>WHITE</td>
      <td>Stage IIIA</td>
      <td>Stage IIIA</td>
      <td>Spindle Cell</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>-15164.0</td>
      <td>Alive</td>
      <td>TUMOR FREE</td>
      <td>1184.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1184.0</td>
      <td>0.0</td>
      <td>1184.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1184.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>12591 rows × 34 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now select the rows which match the disease we are intereseted in, CHOL. Print out the number of rows after the selecton. There should be 45</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">chol_meta_df</span> <span class="o">=</span> <span class="n">meta_df</span><span class="p">[</span><span class="n">meta_df</span><span class="p">[</span><span class="s1">&#39;cancer type abbreviation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CHOL&#39;</span><span class="p">]</span>
<span class="n">chol_meta_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>45</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we are going to read in the data matrix. We will use the metadata we just collected to only load the columns for the cohort of interest. This will save memory and speed up the process. This will still probably take a few seconds.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">chol_meta_df</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">chol_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;tcga_RSEM_gene_tpm.gz&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">columns_to_keep</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To make things less confusing we will rename the "sample" column as "gene" since that is what is actually in that column</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">chol_matrix</span> <span class="o">=</span> <span class="n">chol_matrix</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sample&#39;</span><span class="p">:</span> <span class="s1">&#39;gene&#39;</span><span class="p">})</span>
<span class="n">chol_matrix</span> <span class="o">=</span> <span class="n">chol_matrix</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;gene&#39;</span><span class="p">)</span>
<span class="n">chol_matrix</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TCGA-ZH-A8Y5-01</th>
      <th>TCGA-4G-AAZT-01</th>
      <th>TCGA-W5-AA2R-11</th>
      <th>TCGA-W5-AA2I-01</th>
      <th>TCGA-W5-AA34-01</th>
      <th>TCGA-W5-AA2X-01</th>
      <th>TCGA-W5-AA2H-01</th>
      <th>TCGA-3X-AAVB-01</th>
      <th>TCGA-3X-AAVA-01</th>
      <th>TCGA-ZH-A8Y4-01</th>
      <th>TCGA-W5-AA31-11</th>
      <th>TCGA-W5-AA2U-01</th>
      <th>TCGA-W5-AA2Q-01</th>
      <th>TCGA-ZH-A8Y2-01</th>
      <th>TCGA-W5-AA30-01</th>
      <th>TCGA-WD-A7RX-01</th>
      <th>TCGA-ZU-A8S4-11</th>
      <th>TCGA-W5-AA2U-11</th>
      <th>TCGA-3X-AAVE-01</th>
      <th>TCGA-W5-AA2G-01</th>
      <th>TCGA-W5-AA39-01</th>
      <th>TCGA-4G-AAZO-01</th>
      <th>TCGA-W5-AA2R-01</th>
      <th>TCGA-W5-AA34-11</th>
      <th>TCGA-W5-AA2I-11</th>
      <th>TCGA-W6-AA0S-01</th>
      <th>TCGA-W5-AA2W-01</th>
      <th>TCGA-YR-A95A-01</th>
      <th>TCGA-W5-AA33-01</th>
      <th>TCGA-ZD-A8I3-01</th>
      <th>TCGA-W5-AA2O-01</th>
      <th>TCGA-W5-AA31-01</th>
      <th>TCGA-W5-AA2Q-11</th>
      <th>TCGA-W5-AA36-01</th>
      <th>TCGA-W5-AA38-01</th>
      <th>TCGA-ZU-A8S4-01</th>
      <th>TCGA-W5-AA2Z-01</th>
      <th>TCGA-3X-AAVC-01</th>
      <th>TCGA-W5-AA30-11</th>
      <th>TCGA-ZH-A8Y1-01</th>
      <th>TCGA-3X-AAV9-01</th>
      <th>TCGA-W5-AA2T-01</th>
      <th>TCGA-ZH-A8Y6-01</th>
      <th>TCGA-ZH-A8Y8-01</th>
      <th>TCGA-W5-AA2X-11</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>ENSG00000242268.2</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-4.2934</td>
      <td>-9.9658</td>
      <td>-4.2934</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-4.0350</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-4.0350</td>
      <td>-9.9658</td>
      <td>-3.8160</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
    </tr>
    <tr>
      <th>ENSG00000259041.1</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
    </tr>
    <tr>
      <th>ENSG00000270112.3</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>-6.5064</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-1.9942</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-3.1714</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>-6.5064</td>
      <td>-9.9658</td>
    </tr>
    <tr>
      <th>ENSG00000167578.16</th>
      <td>4.0575</td>
      <td>5.2430</td>
      <td>3.1179</td>
      <td>4.3716</td>
      <td>4.6282</td>
      <td>4.7203</td>
      <td>6.7259</td>
      <td>5.4233</td>
      <td>4.4243</td>
      <td>4.8105</td>
      <td>3.2841</td>
      <td>3.9892</td>
      <td>3.8778</td>
      <td>5.6244</td>
      <td>4.7345</td>
      <td>4.9175</td>
      <td>3.3647</td>
      <td>3.4277</td>
      <td>4.8405</td>
      <td>4.0046</td>
      <td>5.7520</td>
      <td>4.6955</td>
      <td>5.0104</td>
      <td>3.1393</td>
      <td>3.2282</td>
      <td>4.9855</td>
      <td>5.9074</td>
      <td>4.2958</td>
      <td>4.6106</td>
      <td>4.8510</td>
      <td>4.5940</td>
      <td>5.3035</td>
      <td>3.8993</td>
      <td>4.6525</td>
      <td>5.6795</td>
      <td>5.4216</td>
      <td>4.2297</td>
      <td>4.6101</td>
      <td>3.7846</td>
      <td>4.8802</td>
      <td>4.8905</td>
      <td>4.2025</td>
      <td>5.7632</td>
      <td>5.1611</td>
      <td>3.8808</td>
    </tr>
    <tr>
      <th>ENSG00000278814.1</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>ENSG00000273233.1</th>
      <td>-9.9658</td>
      <td>-1.9942</td>
      <td>-9.9658</td>
      <td>-1.5951</td>
      <td>-3.3076</td>
      <td>-9.9658</td>
      <td>-3.4580</td>
      <td>-3.0469</td>
      <td>-3.1714</td>
      <td>-0.6873</td>
      <td>-9.9658</td>
      <td>-2.2447</td>
      <td>-3.1714</td>
      <td>-9.9658</td>
      <td>-0.1504</td>
      <td>-3.4580</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-3.0469</td>
      <td>-2.2447</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-3.6259</td>
      <td>-3.4580</td>
      <td>-2.7274</td>
      <td>-9.9658</td>
      <td>-3.0469</td>
      <td>-1.9379</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-1.2828</td>
      <td>-9.9658</td>
      <td>-1.9942</td>
      <td>-3.1714</td>
      <td>-9.9658</td>
      <td>-3.3076</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-0.9132</td>
      <td>-3.1714</td>
      <td>-3.4580</td>
      <td>-9.9658</td>
    </tr>
    <tr>
      <th>ENSG00000105063.18</th>
      <td>5.1157</td>
      <td>4.9901</td>
      <td>3.5187</td>
      <td>5.1277</td>
      <td>4.6713</td>
      <td>4.9322</td>
      <td>6.0830</td>
      <td>5.5604</td>
      <td>5.1056</td>
      <td>4.8445</td>
      <td>3.2374</td>
      <td>4.9275</td>
      <td>4.7049</td>
      <td>5.2327</td>
      <td>4.9589</td>
      <td>4.6910</td>
      <td>2.9224</td>
      <td>2.8462</td>
      <td>5.4266</td>
      <td>5.3005</td>
      <td>4.3876</td>
      <td>5.4654</td>
      <td>5.0246</td>
      <td>3.3842</td>
      <td>2.8096</td>
      <td>4.0207</td>
      <td>5.8985</td>
      <td>4.6944</td>
      <td>5.4199</td>
      <td>4.9741</td>
      <td>5.1027</td>
      <td>5.8483</td>
      <td>3.5742</td>
      <td>5.1211</td>
      <td>5.4019</td>
      <td>5.2114</td>
      <td>4.7939</td>
      <td>5.8783</td>
      <td>2.9839</td>
      <td>5.0747</td>
      <td>5.0352</td>
      <td>5.2250</td>
      <td>5.6744</td>
      <td>4.9978</td>
      <td>3.4778</td>
    </tr>
    <tr>
      <th>ENSG00000231119.2</th>
      <td>-4.2934</td>
      <td>-5.5735</td>
      <td>-3.8160</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>-2.6349</td>
      <td>-5.5735</td>
      <td>-3.3076</td>
      <td>-9.9658</td>
      <td>-4.0350</td>
      <td>-3.1714</td>
      <td>-4.2934</td>
      <td>-5.5735</td>
      <td>-9.9658</td>
      <td>-4.0350</td>
      <td>-2.8262</td>
      <td>-3.4580</td>
      <td>-5.0116</td>
      <td>-4.6082</td>
      <td>-3.6259</td>
      <td>-5.0116</td>
      <td>-4.2934</td>
      <td>-3.8160</td>
      <td>-3.0469</td>
      <td>-4.0350</td>
      <td>-4.2934</td>
      <td>-2.2447</td>
      <td>-3.6259</td>
      <td>-3.8160</td>
      <td>-5.5735</td>
      <td>-4.6082</td>
      <td>-2.1140</td>
      <td>-3.0469</td>
      <td>-9.9658</td>
      <td>-3.6259</td>
      <td>-1.8314</td>
      <td>-3.8160</td>
      <td>-4.6082</td>
      <td>-3.3076</td>
      <td>-3.1714</td>
      <td>-2.4659</td>
      <td>-4.0350</td>
      <td>-2.4659</td>
      <td>-2.7274</td>
      <td>-2.9324</td>
    </tr>
    <tr>
      <th>ENSG00000280861.1</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
    </tr>
    <tr>
      <th>ENSG00000181518.3</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
    </tr>
  </tbody>
</table>
<p>60498 rows × 45 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have our matrix we are ready to start calculating metrics</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="calculating-metrics">Calculating Metrics<a class="headerlink" href="#calculating-metrics" title="Permanent link">&para;</a></h2>
<p>The input for an analysis where a patient sample is being compared to the TCGA cohort of interest would typically be an expression matrix using the same normalization method as the comparator cohort. </p>
<p><strong>Note</strong>: Differences in library preparation, sequencing and bioinformatics pipelines can lead to variation in expression quantification. It is important to understand the impact these differences have on expression quantification before comparing expression values that are produced using different pipelines.</p>
<p>For the purposes of this tutorial we are going to choose one of the CHOL samples from our expression matrix to use as our input. We arbitrarily chose the first sample.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">test_sample_id</span> <span class="o">=</span> <span class="n">chol_meta_df</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="percentile">Percentile<a class="headerlink" href="#percentile" title="Permanent link">&para;</a></h3>
<p>We will start by calculating the percentile rank</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">percentiles</span> <span class="o">=</span> <span class="n">chol_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">percentiles</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">percentiles</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TCGA-ZH-A8Y5-01</th>
      <th>TCGA-4G-AAZT-01</th>
      <th>TCGA-W5-AA2R-11</th>
      <th>TCGA-W5-AA2I-01</th>
      <th>TCGA-W5-AA34-01</th>
      <th>TCGA-W5-AA2X-01</th>
      <th>TCGA-W5-AA2H-01</th>
      <th>TCGA-3X-AAVB-01</th>
      <th>TCGA-3X-AAVA-01</th>
      <th>TCGA-ZH-A8Y4-01</th>
      <th>TCGA-W5-AA31-11</th>
      <th>TCGA-W5-AA2U-01</th>
      <th>TCGA-W5-AA2Q-01</th>
      <th>TCGA-ZH-A8Y2-01</th>
      <th>TCGA-W5-AA30-01</th>
      <th>TCGA-WD-A7RX-01</th>
      <th>TCGA-ZU-A8S4-11</th>
      <th>TCGA-W5-AA2U-11</th>
      <th>TCGA-3X-AAVE-01</th>
      <th>TCGA-W5-AA2G-01</th>
      <th>TCGA-W5-AA39-01</th>
      <th>TCGA-4G-AAZO-01</th>
      <th>TCGA-W5-AA2R-01</th>
      <th>TCGA-W5-AA34-11</th>
      <th>TCGA-W5-AA2I-11</th>
      <th>TCGA-W6-AA0S-01</th>
      <th>TCGA-W5-AA2W-01</th>
      <th>TCGA-YR-A95A-01</th>
      <th>TCGA-W5-AA33-01</th>
      <th>TCGA-ZD-A8I3-01</th>
      <th>TCGA-W5-AA2O-01</th>
      <th>TCGA-W5-AA31-01</th>
      <th>TCGA-W5-AA2Q-11</th>
      <th>TCGA-W5-AA36-01</th>
      <th>TCGA-W5-AA38-01</th>
      <th>TCGA-ZU-A8S4-01</th>
      <th>TCGA-W5-AA2Z-01</th>
      <th>TCGA-3X-AAVC-01</th>
      <th>TCGA-W5-AA30-11</th>
      <th>TCGA-ZH-A8Y1-01</th>
      <th>TCGA-3X-AAV9-01</th>
      <th>TCGA-W5-AA2T-01</th>
      <th>TCGA-ZH-A8Y6-01</th>
      <th>TCGA-ZH-A8Y8-01</th>
      <th>TCGA-W5-AA2X-11</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>ENSG00000242268.2</th>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>92.0</td>
      <td>46.0</td>
      <td>92.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>97.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>97.0</td>
      <td>46.0</td>
      <td>100.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>ENSG00000259041.1</th>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>ENSG00000270112.3</th>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>92.0</td>
      <td>92.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>100.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>98.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>44.0</td>
      <td>92.0</td>
      <td>92.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>ENSG00000167578.16</th>
      <td>29.0</td>
      <td>80.0</td>
      <td>2.0</td>
      <td>38.0</td>
      <td>49.0</td>
      <td>56.0</td>
      <td>100.0</td>
      <td>87.0</td>
      <td>40.0</td>
      <td>60.0</td>
      <td>9.0</td>
      <td>24.0</td>
      <td>18.0</td>
      <td>89.0</td>
      <td>58.0</td>
      <td>71.0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>62.0</td>
      <td>27.0</td>
      <td>93.0</td>
      <td>53.0</td>
      <td>76.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>73.0</td>
      <td>98.0</td>
      <td>36.0</td>
      <td>47.0</td>
      <td>64.0</td>
      <td>42.0</td>
      <td>82.0</td>
      <td>22.0</td>
      <td>51.0</td>
      <td>91.0</td>
      <td>84.0</td>
      <td>33.0</td>
      <td>44.0</td>
      <td>16.0</td>
      <td>67.0</td>
      <td>69.0</td>
      <td>31.0</td>
      <td>96.0</td>
      <td>78.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>ENSG00000278814.1</th>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>ENSG00000273233.1</th>
      <td>23.0</td>
      <td>86.0</td>
      <td>23.0</td>
      <td>91.0</td>
      <td>59.0</td>
      <td>23.0</td>
      <td>52.0</td>
      <td>73.0</td>
      <td>66.0</td>
      <td>98.0</td>
      <td>23.0</td>
      <td>81.0</td>
      <td>66.0</td>
      <td>23.0</td>
      <td>100.0</td>
      <td>52.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>73.0</td>
      <td>81.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>47.0</td>
      <td>52.0</td>
      <td>78.0</td>
      <td>23.0</td>
      <td>73.0</td>
      <td>89.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>93.0</td>
      <td>23.0</td>
      <td>86.0</td>
      <td>66.0</td>
      <td>23.0</td>
      <td>59.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>96.0</td>
      <td>66.0</td>
      <td>52.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>ENSG00000105063.18</th>
      <td>64.0</td>
      <td>49.0</td>
      <td>18.0</td>
      <td>69.0</td>
      <td>27.0</td>
      <td>42.0</td>
      <td>100.0</td>
      <td>89.0</td>
      <td>62.0</td>
      <td>38.0</td>
      <td>11.0</td>
      <td>40.0</td>
      <td>33.0</td>
      <td>76.0</td>
      <td>44.0</td>
      <td>29.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>84.0</td>
      <td>78.0</td>
      <td>24.0</td>
      <td>87.0</td>
      <td>53.0</td>
      <td>13.0</td>
      <td>2.0</td>
      <td>22.0</td>
      <td>98.0</td>
      <td>31.0</td>
      <td>82.0</td>
      <td>47.0</td>
      <td>60.0</td>
      <td>93.0</td>
      <td>20.0</td>
      <td>67.0</td>
      <td>80.0</td>
      <td>71.0</td>
      <td>36.0</td>
      <td>96.0</td>
      <td>9.0</td>
      <td>58.0</td>
      <td>56.0</td>
      <td>73.0</td>
      <td>91.0</td>
      <td>51.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>ENSG00000231119.2</th>
      <td>37.0</td>
      <td>17.0</td>
      <td>54.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>89.0</td>
      <td>17.0</td>
      <td>70.0</td>
      <td>6.0</td>
      <td>46.0</td>
      <td>74.0</td>
      <td>37.0</td>
      <td>17.0</td>
      <td>6.0</td>
      <td>46.0</td>
      <td>84.0</td>
      <td>67.0</td>
      <td>23.0</td>
      <td>29.0</td>
      <td>62.0</td>
      <td>23.0</td>
      <td>37.0</td>
      <td>54.0</td>
      <td>79.0</td>
      <td>46.0</td>
      <td>37.0</td>
      <td>96.0</td>
      <td>62.0</td>
      <td>54.0</td>
      <td>17.0</td>
      <td>29.0</td>
      <td>98.0</td>
      <td>79.0</td>
      <td>6.0</td>
      <td>62.0</td>
      <td>100.0</td>
      <td>54.0</td>
      <td>29.0</td>
      <td>70.0</td>
      <td>74.0</td>
      <td>92.0</td>
      <td>46.0</td>
      <td>92.0</td>
      <td>87.0</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>ENSG00000280861.1</th>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>ENSG00000181518.3</th>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
      <td>51.0</td>
    </tr>
  </tbody>
</table>
<p>60498 rows × 45 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can plot a couple of these as a sanity check. The line plots should never go up and then down again</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">gene</span> <span class="o">=</span> <span class="s1">&#39;ENSG00000105063.18&#39;</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">chol_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">gene</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">percentiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">gene</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Percentile Rank&#39;</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>&lt;seaborn.axisgrid.FacetGrid at 0x7f6b96ba7f50&gt;</code>
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAW4AAAFuCAYAAAChovKPAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deVhTZ8I28DsQdgjKLogLWATRIu5rKVi1mxUtttplRqtDO11ca5dp7TatzvS11i7fdIZpZ1ptX7tYxVY7oy2oaF2riFVRWUXWsO9JSHK+P6h5SwVDgOTkJPfvuryUk5hzc6K3j0/OOY9MEAQBREQkGQ5iByAiItOwuImIJIbFTUQkMSxuIiKJYXETEUmMpIs7JydHtH0XFhaKtm9TSSkrIK28zGo+Uspr6aySLm6tVivavltbW0Xbt6mklBWQVl5mNR8p5bV0VkkXNxGRPWJxExFJDIubiEhiWNxERBLD4iYikhgWNxGRxLC4iYgkhsVNRCQxLG4iIolhcRMRSYzZivv555/H5MmTcffddxu21dXVYcmSJZg1axaWLFmC+vp6AIAgCHj99dcxc+ZMzJkzB+fPnzdXLCIiyTNbcc+fPx8ffvhhh20pKSmYPHky9u3bh8mTJyMlJQUAkJGRgcLCQuzbtw9//vOf8corr5grFhGR5JmtuMePHw9vb+8O29LS0pCYmAgASExMxA8//NBhu0wmw+jRo9HQ0AClUmmuaEREZlder8IHB/Lw7Paz0On7dmlfeZ++mhHV1dUICAgAAPj7+6O6uhoAUFFRgaCgIMPzgoKCUFFRYXhuV9RqNbKzs80X+AZUKpVo+zaVlLIC0srLrOYjpbzXsqq1ehwtasEPeY3ILGuFXgDGBrvh3IVsODvKTH7dqKioTrdbtLh/TSaTQSYz/Rv5NRcXly6/MXPLzs4Wbd+mklJWQFp5mdV8pJJXEAR8nXEGpwrasDurDI1qLUL6ueGJ+GGYP2Yghvp59Pk+LVrcvr6+UCqVCAgIgFKphI+PDwAgMDAQ5eXlhueVl5cjMDDQktGIiExSXNuCnadLsCOzBAVVzXBzcsQdo4KQNGYgJoX5wsGhdwPTG7FocSckJCA1NRXJyclITU3FjBkzDNs//fRT3HXXXcjKyoKXl5fRaRIiIktr0Wjxn5/L8fXpYhzJa5/qnRTmg3nD3fHIrDHwdLFMpZptL6tXr8aJEydQW1uLW265BU899RSSk5OxcuVKbN++HcHBwdi8eTMAIC4uDgcPHsTMmTPh5uaG9evXmysWEZFJ9HoBxwtq8PXpYnz3cxlaNDoM8nHHqtsiMH9MCEJ93JGdnW2x0gbMWNybNm3qdPsnn3xy3TaZTIaXX37ZXFGIiHokr7IJi/99AldrWuHpIsecm4Nx79iBGD+kf68/o+sN0T6cJCKydp8dK0JFgxqb7x+N2dFBcHN2FDsSABY3EVGX0i9WYHKYLxJjQ8SO0gHvVUJE1In8yiYUVrdgRpT1nSjB4iYi6kT6xfart+OHs7iJiCQh/aISNwV4ItTHXewo12FxExH9RqOqDScKapBghdMkAIubiOg6h3OqoNULVjlNArC4iYius/+SEl6ucowd3F/sKJ1icRMR/YpeL2D/pUrcEuEPJ0frrEjrTEVEJJILZQ2obFRb7TQJwOImIuog/aISMhlw63B/saN0icVNRPQr+y8pcfPAfvDzdBE7SpdY3EREv6hp1uDM1TrEW/FoG2BxExEZHLyshCAACZHWO78N8CZTRETQaPX4IbsCHxzIg5+nC0YGexv/TSJicROR3cqvbMIXJ69i+6liVDdrEOztipfmjDDrsmN9gcVNRHZF1abDf8+VY9uJIhwvqIGjgwwzIgOwaMIg3BLhD0crL22AxU1EduJyRSO2nSjCzswS1LW0YZCPO9bOHo4FYwciQOEqdjyTsLiJyGa1aLTYfbYMn58owumiOjg5yjA7OgiLJgzCZDOvxG5OLG4isjnnSuqx7UQRvjlTika1FuH+HnjxrijMHzMQPh7OYsfrNRY3EdmMcyX1ePXb8zhZWAsXuQPuGjUAiyYOwrjB4i7u29dY3EQkefWtbdi07xK2HruC/u7OeHnOCMyPHQhvdyexo5kFi5uIJEsQBOw4XYIN/8lGTbMGD08ajNWzhsPbzTYL+xoWNxFJUnZZA17adQ4nC2sRO6gfPl4yASNDrPvCmb7C4iYiSWlUteHt73PwydFCeLs54c17b0bS2IGSPUOkJ1jcRCQJgiDgm6xSvL4nG1VNajwwYRDWzh6Ofu7SP0vEVCxuIrJ6ygYV1nyVhUM5VYgZ6I2Pfj8ONw/sJ3Ys0bC4iciqpWVXYO32s2jRaPHnxJF4cMIgu5oW6QyLm4iskkanxyvfnMfHRwoRNUCB9xaNxrAAL7FjWQUWNxFZnVxlI1buKUVBrQZLpg7Bs7dHwtXJUexYVoPFTURWQxAEbDtxFa/tPg8XR+Dfi8cj3soXNRADi5uIrEJdiwbPff0z/nu+HNNv8sNjo90xlaXdKRY3EYlOq9Pj3g+OoKimBX+6MxLLpoXh0qWLYseyWixuIhLdoZwq5FU2452FozF3dIjYcaweFwsmItFtP1UMHw9n3DFygNhRJIHFTUSiqmvR4PsLFZg7OhjOclZSd/AoEZGovskqhUanR9LYgWJHkQwWNxGJ6qufijFigALRwfZxZ7++wOImItFcLG/AzyX1HG2biMVNRKLZ/lMxnBxlSIzlmSSmYHETkSjadHqknilBQmSATSzga0ksbiISxbH8alQ1aXDvGE6TmIrFTUSiKKxuAQCMDrXf+2r3FIubiERR2aCCgwzw9XQRO4rksLiJSBTKRjV8PV3gaOeLIvQEi5uIRKFsVCPAi6PtnmBxE5EolI0qFncPsbiJyOIEQUBZnQoBXq5iR5EkFjcRWVx+VTOqmzWI4RklPcLiJiKLO5JbBQCYOsxX5CTSJMpCCh9//DG++uoryGQyREREYMOGDVAqlVi9ejXq6uoQHR2NN998E87OvJqKyBb9mFuNkH5uGOTjLnYUSbL4iLuiogJbtmzB119/jd27d0On02HPnj3YuHEjFi9ejO+//x4KhQLbt2+3dDQisgCdXsDR/GpMHeYLmYynAvaEKFMlOp0OKpUKWq0WKpUK/v7+OHbsGGbPng0AmDdvHtLS0sSIRkRmdr60HvWtbZg6zE/sKJJl8amSwMBAPPLII4iPj4eLiwumTp2K6OhoKBQKyOXtcYKCglBRUWHpaERkZsW1LXh9dzZkMmByOOe3e8rixV1fX4+0tDSkpaXBy8sLK1aswKFDh3r0Wmq1GtnZ2X2csHtUKpVo+zaVlLIC0srLrN0jCAL25jQi5adqQABWTfFHdXEBqm/we3hsgaioqE63W7y4jxw5goEDB8LHxwcAMGvWLJw+fRoNDQ3QarWQy+UoLy9HYGCg0ddycXHp8hszt+zsbNH2bSopZQWklZdZjatoUOHZr8/iwKUqTA7zxZtJNyO0Gx9K8th2zeJz3MHBwcjKykJraysEQcDRo0cxbNgwTJw4EXv37gUA7Ny5EwkJCZaORkR9SBAEpGaWYNbbGTiWX41X74nGZ8smdqu06cYsPuKOiYnB7NmzMW/ePMjlckRFReH+++/HrbfeilWrVmHz5s2IiorCggULLB2NiPpIVZMaL+z8GXvPV2DMoH54677RGOrnIXYsmyHKedzLly/H8uXLO2wLDQ3lKYBENuC/58rwp53n0KTS4vk7IrFsehjvANjHRCluIrJN76fnYOO+yxgV4o237otBRKCX2JFsEoubiPrE3w7kYuO+y5gXG4I3k26GkyPvqGEuLG4i6rWUjDy8+d9LmDs6GBsXxHBqxMz4TyIR9cqHh/Kx/ruLuPvmAXiLpW0RLG4i6rF/HS7A63uyceeoIGy+fzTknB6xCB5lIuqRT44U4rXdFzA7OhDvLIxlaVsQjzQRmaykrhUvf3Met0UF4L1FY/hBpIXxaBORyUrrWgEAv5s8BM5y1oil8YgTkclqmzUAgP7uXOxEDCxuIjJZXUsbAKCfu5PISewTi5uITFbb8suI24MjbjGwuInIZLUtbXBylMHD2VHsKHaJxU1EJqtr0aCfuzPXjBQJi5uITFbTrIEPP5gUDYubiExW19LGDyZFxOImIpNVNqnh68kRt1hY3ERkkia1FoXVzRgeqBA7it1icRORSS6UNkAQgFEDWdxiYXETkUnOldQDAEYGe4ucxH6xuInIJOdK6hHg5YIAhavYUewWi5uITHKutB6jQjjaFhOLm4i6RRAEvJ+eg8sVTRgzuL/Ycewa15wkIqNaNTqs3Z6F3WfLMC82BEunDRU7kl1jcRPRDZXWtSJ56084X9qA5+6IxKO3hPFSd5GxuImoS6eu1ODRraehatPho9+PQ0JkoNiRCCxuIurClz9dxYs7zyG4nys+T56IYQFeYkeiX7C4iagDvV7AG99l46PDBZg2zA/vPxCLfryhlFVhcRNRB8cKqvHR4QI8NGkQXpkTzdXbrRDfESLqoLi2fSHgR28JZ2lbKb4rRNRBZaMaAODv5SJyEuoKi5uIOqhsVMPLVQ5XJy5LZq1Y3ETUgbJRxdG2lWNxE1EHlY1qBLC4rRqLm4g6qG7SwNeTxW3NWNxE1EGjWguFK88UtmYsbiLqoEmlhacLi9uasbiJyECnF9DapoMHi9uqsbiJyKBJrQUAjritHIubiAyaWdySwOImIgPDiJsfTlo1FjcRGVwrbs5xWzcWNxEZcKpEGljcRGRQ06wBAPRzcxI5Cd0Ii5uIDAqrWiCTAaE+7mJHoRswWtwajea6bXV1dWYJQ0TiKqhqQrC3G+8MaOWMFveTTz6JtrY2w9dKpRKPPPKIWUMRkTgKqlsw1M9D7BhkhNHivu2227By5UrodDoUFxdj6dKlWL16tSWyEZEFCYKAgsomFrcEGP3o+L777kNbWxueeOIJlJSU4NVXX8WYMWMskY2ILKimWYMGlRZDWNxWr8vi/ve//234tSAIKC0tRWRkJLKyspCVlYUlS5ZYJCARWUZZvQoAMLC/m8hJyJgui7u5ubnD17Nmzep0OxHZBp7DLR1dvkNPPvmkJXMQkcha2nQAADdnnlFi7Yz+01pQUIB//etfKCkpgVarNWzfsmVLj3fa0NCAF198EZcvX4ZMJsP69esxdOhQrFq1CiUlJQgJCcHmzZvh7e3d430QkWlaNe3F7c7itnpGi3vFihVYuHAhFixYAAeHvrle54033sD06dPx7rvvQqPRQKVS4e9//zsmT56M5ORkpKSkICUlBWvXru2T/RGRcS3XituJUyXWzmgTy+VyPPDAA7j55psxcuRIw4+eamxsxMmTJ5GUlAQAcHZ2hkKhQFpaGhITEwEAiYmJ+OGHH3q8DyIyXesvUyWuzryg2toZ/ac1Pj4en332GWbOnAlnZ2fD9n79+vVoh8XFxfDx8cHzzz+PixcvIjo6Gi+88AKqq6sREBAAAPD390d1dbXR11Kr1cjOzu5Rjt5SqVSi7dtUUsoKSCuvLWU9cqESLo4ylF3JR7WjzILJOmdLx7anoqKiOt1utLh37twJAPjoo48M22QyGdLS0noURKvV4sKFC1i3bh1iYmLw+uuvIyUlpcNzZDIZZDLjf3BcXFy6/MbMLTs7W7R9m0pKWQFp5bWVrI2qNhzcdgX3jA5BzMgRFk7WOVs5tuZgtLjT09P7dIdBQUEICgpCTEwMAOD2229HSkoKfH19oVQqERAQAKVSCR8fnz7dLxF1LTWzBC0aHR6aNFjsKNQN3foU4vLly8jNze1ww6lr89Gm8vf3R1BQEPLz8xEWFoajR48iPDwc4eHhSE1NRXJyMlJTUzFjxowevT4RmUYQBHx2vAgjQxS4eSDP5JICo8X9/vvv4/jx48jLy0NcXBwyMjIwduzYHhc3AKxbtw5PP/002traEBoaig0bNkCv12PlypXYvn07goODsXnz5h6/PhF136krtbhY3ogN80d1a4qSxGe0uPfu3Ytdu3YhMTERGzZsQFVVVa9P04uKisKOHTuu2/7JJ5/06nWJyHSfHS+Cl4sc98QEix2FusnoeT8uLi5wcHCAXC5HU1MTfH19UVZWZolsRGRmORWN+CarFPeOHch1JiXE6Ds1cuRINDQ0YMGCBZg/fz7c3d0RGxtriWxEZEaCIOC13Rfg7uyIpxKGiR2HTGC0uF955RUAwKJFizB9+nQ0NTUhMjLS3LmIyMzSLypxKKcKL94VBV9PF7HjkAluOFWi0+lQU1Nj+DogIABZWVm44447zB6MiMxHo9Xj9T3ZCPP3wO8mDxE7Dpmoy+Les2cPJkyYgHvuuQcPPfQQDh8+jNtuuw0ZGRnYuHGjJTMSUR/bcrQQBVXNWHfXCDjLeYm71HQ5VfLBBx9gx44dGDx4MM6fP4/7778f7777LhISEiyZj4j6WE2zBu+k5SAuwh/xkQFix6Ee6PKfWicnJwwe3H4VVXR0NIYMGcLSJrIBP+ZWoVGlxYrbbhI7CvVQlyPu6urqDsuXNTQ0dPiaS5cRSVNFQ/sSZWFcW1Kyuizu++67r8MyZb/9moikSdmohovcAd5uTmJHoR7i0mVEdqaiQYVAhSsvb5cwfpxMZGfK61UIVPC8bSljcRPZGWWjGoEKV7FjUC+wuInsiCAIhqkSki6jxV1VVYU//elPWLZsGQAgNzcXX331ldmDEVHfa1Jr0aLRcapE4owW93PPPYdp06ZBqVQCAIYMGYItW7aYPRgR9b1rpwJyxC1tRou7trYWd955Jxwc2p8ql8sNvyYiaTma174Id0Sgl8hJqDeMNrC7uztqa2sNpw6dOXMGXl5804mk6POTVxEdrEDUAIXYUagXjN7W9bnnnsMf//hHFBUVYeHChaitrcU777xjiWxE1Idyq9U4X9qAP8+NFjsK9ZLR4o6Ojsann36KgoICCIKAoUOHwsmJV1wRSc1/cxrhInfAPaNDxI5CvdRlce/bt6/T7YWFhQCAWbNmmSUQEfW9Vo0O+/MbcdeoYF7qbgO6LO79+/ff8DeyuImk4z/nytDSJuD+8aFiR6E+0GVxb9iwwZI5iMiMThbWQuHigAlDfcSOQn2gy+LetWsX5s6d2+FWrr/G27oSSUd5fSsCPOS8sZSN6LK4W1tbAYC3ciWyAWX1Kvh7GD0XgSSiy3dy4cKFAIDJkydj7NixHR47deqUeVMRUZ8qrWvFTYPdxY5BfcToBTivv/56t7YRkXVqVmvRoNLCjyNum9HlO5mZmYnMzEzU1NR0mOduamqCTqezSDgi6r2y+vb7k3CqxHZ0+U62tbWhpaUFOp2uwzy3p6cn3n33XYuEI6Leu1jeAAAIUfD8bVvRZXFPmDABEyZMwLx58xASwiutiKTqp8JauDs7ItzHWewo1EeM/t9Jo9Fg3bp1KCkpgVarNWznrV2JpOFkYQ1Gh/aDowNPBbQVRot7xYoVWLhwIRYsWMDbuRJJTJNai+yyBjyZcBMAfjZlK4wWt1wuxwMPPGCJLETUxzKLaqEXgHGD+wO6KrHjUB8xOoSOj4/HZ599BqVSibq6OsMPIrJ+Jwtr4SADYgf1EzsK9SGjI+6dO3cCAD766CPDNplMhrS0NPOlIqI+cbGsAUP9PODlyjNKbInR4k5PT7dEDiIyg4KqZoT5e4odg/qY0amS1tZW/O1vf8O6desAtN+P29gtX4lIfDq9gCs1LQjz8xA7CvUxo8X9/PPPw8nJCZmZmQCAwMBAbN682ezBiKh3SutaodHqMZTFbXOMFndRURH+8Ic/QC5vn1Vxc3ODIAhmD0ZEvVNQ1X7F8xAWt80xWtzOzs5QqVSG+/gWFRXB2ZlXYBFZu2vFzakS22P0w8mnnnoKy5YtQ1lZGdasWYPMzEyujkMkAQVVzfBwdoS/l4vYUaiPGS3uqVOnYsSIEcjKyoIgCHjhhRfg48Plj4isXUFVM4b6e3DVGxtkdKrk+++/h1wux6233or4+HjI5XL88MMPlshGRL2QV9mEoX48FdAWGS3u999/H15eXoavFQoF3n//fbOGIqLeOV9aj+LaVozlFZM2yWhx6/X667ZxIQUi6/blyatwljsgMZa3ZLZFRot75MiR2LBhA4qKilBUVIQNGzYgOjraEtmIqAdUbTrszCzB7dFB6OfOM8BskdHiXrduHZycnLBy5UqsWrUKLi4ueOmllyyRjYh6YO/5cjSotFg4PlTsKGQmNzyrRKfT4dFHH8XWrVstlYeIeumLk1cR6uOGSWG+YkchM7nhiNvR0REODg5obGy0VB4i6oWrNS04kleN+8eFwoEr3tgso+dxu7u7Y86cOZgyZQrc3d0N21988UWzBiMi0+VWNgEAJodztG3LjBb3rFmzMGvWLEtkIaJeamhtAwB+KGnjjBb3vHnzoFKpUFpairCwMEtkIqIeqmtpL25vNy6cYMuMnlWSnp6OuXPnYtmyZQCA7OxsPPbYY73esU6nQ2JiIh599FEAwNWrV7FgwQLMnDkTK1euhEaj6fU+iOxNfSuL2x5068rJ7du3Q6FQAACioqJQXFzc6x1v2bIF4eHhhq83btyIxYsX4/vvv4dCocD27dt7vQ8ie1PX0gYPZ0c4ORr9q00SZvTdlcvlHS55B9Drm9aUl5fjwIEDSEpKAgAIgoBjx45h9uzZANqnZ7imJZFp2nR6XCxv4GjbDhid4x42bBi+/fZb6HQ6FBYWYuvWrYiNje3VTtevX4+1a9eiubn9fsG1tbVQKBSGxRqCgoJQUVFh9HXUajWys7N7laWnVCqVaPs2lZSyAtLKay1ZG9U6vHGgAlnlKiwe07/TTNaStbuklNdcWaOiojrdbrS4161bh7///e9wdnbGmjVrMG3aNDz++OM9DrJ//374+Phg5MiROH78eI9fBwBcXFy6/MbMLTs7W7R9m0pKWQFp5bWGrLnKRqz95CeU1Wnw1oIY3Dt2YKfPs4asppBSXktn7bK41Wo1tm3bhqKiIkREROCLL74wjIh74/Tp00hPT0dGRgbUajWamprwxhtvoKGhAVqtFnK5HOXl5QgMDOz1vohs3f5LSiz/30y4ODlgW/IkjB3cX+xIZAFdznE/++yzOHfuHCIiIpCRkYG//vWvfbLDNWvWICMjA+np6di0aRMmTZqEt956CxMnTsTevXsBADt37kRCQkKf7I/IFgmCgA8P5WPpxycR6uOOXU9OY2nbkS6H0Hl5efj2228BAElJSViwYIFZg6xduxarVq3C5s2bERUVZfb9EUmVWqvDizvP4atTxbg9Ogib7o+Bu3Pv/zdM0tHlu/3raZG+mCLpzMSJEzFx4kQAQGhoKE8BJDJCq9Nj6cc/4XBuFZYnDMPK2yJ4TxI71GUjX7x4EWPGjAHQ/t8ytVqNMWPGQBAEyGQynD592mIhiajdu2k5OJxbhQ3zR2HRhEFixyGRdFncUjkNh8heHMmrwnv7c5E0diBL287x8ioiCahqUmPl52cw1M8Dr97DFajsHYubyMrp9QLWfJmFutY2/L8HxsDDhR9E2jsWN5GV+/BwPg5ersS6u0cgaoBC7DhkBVjcRFbsREEN3vzvJdwxMggPTeS8NrVjcRNZqfzKJiRv/QmDfN3xl/k39/rmbmQ7WNxEVqi6SY0lH5+Eo0yGjxdPgLc77/hH/4efchBZGVWbDslbT6G8XoVtyZMwyNfd+G8iu8LiJrIier2ANV9l4dSVWvztwTEYM4j3H6HrcaqEyIr8z75L2HO2DM/fEYk7Rw0QOw5ZKRY3kZXYdqIIHxzIwwMTByH5Fi7MTV1jcRNZgYzLlXgx9RziIvzx2j3RPIOEbojFTSSyi+UNePyz07gpwBPvPxALORf6JSP4J4RIRIIg4LGtp+Dh4oh/LxkPL1ee9kfGsbiJRFTVpEFhdQsevSUcA7zdxI5DEsHiJhJRfmUTACA8wFPkJCQlLG4iEeVVNgMAwvw8RE5CUsLiJhJRfmUTXOQOCOnHaRLqPhY3kYjyq5ox1M+D60aSSVjcRCIqrGpGmD+nScg0LG4iEdW2aODr4SJ2DJIYFjeRiJrVOi5FRiZjcROJRKPVQ6PTw8PZUewoJDEsbiKRtGi0AMARN5mMxU0kkmaNDgDgyeImE7G4iURS16IBwBE3mY7FTSSSY/k1AICbB3qLnISkhsVNJJIDl5QYFuCJUB+uKUmmYXETiaBFo8Xx/BrcGuEvdhSSIBY3kQiO5FZDo9MjPjJA7CgkQSxuIhEcuKyEu7Mjxg3hKu5kOn6cTWQhWp0eh3KrsPN0Cf57vhy3RvjDRc6Lb8h0LG4iMxIEAedLG7DjdAm+ySpFVZMa/dydcN+4gXgifpjY8UiiWNxEZlBa14rUMyXYeboEOcomODs6YEZUABJjQxA/PADOcs5SUs+xuIn6SKOqDf/5uRw7MotxvKAGggCMG9wfb8wbibtHBcPbnQsBU99gcRP1glYvIP1iBXacLsH3Fyqg1uoxxNcdK2dEYF5sCAb58hxt6nssbiITCYKAcyUN+Pp0MXaeLkK9quCXeetQzBsTgtjQfpDJuKINmQ+Lm6ibSupakZpZgp2ZJcj9Zd56/EA3/P6WSNzKeWuyIBY30Q00qNrwn5/LsON0CY4XtN9bZPyQ/lg/bxTuGjUApVdyERUVJHJKsjcsbqLfaNXocCSvCjsyS/DDL/PWQ/08sHpm+7z1r+8tUipiTrJfLG6ya5WNalwoa8CF0oZffq5HQVUz9ALQ390J948PxbzYEIzmvDVZERY32QWdXkBhdfOvCrr958pGteE5If3cMCJYgbtvDsbo0H6YOsyP89ZklVjcZHNaNFpcLG/EhdIGZJe1F/TFska0trWvOOPkKMNNAV6Ii/DHiAEKjAhWICpIwfOsSTJY3CRpykbVdaPogqpmCEL74wpXOUYEK7BowiCMCFZgxAAFhgV4ciRNksbiJknQ6QUUVDX/Zj66AVVN/zfVEerjhhEDFJgbE4KoAV4YEaxASD83zk2TzWFxk9Vp0uhw6kqtYZrjQmkDLpY3QNWmB9A+1RER6IX44f6GUXTkAAW83TjVQfaBxU2i0OkFFNe2IL+yGXmVTcj75ef8yuZfRmou8QgAABAgSURBVNFXAADebk4YMUCBBycONsxHh/tzqoPsG4ubzKq+tQ35vxTytWLOr2pCYVULNDq94Xk+Hs4I8/PAjMgAeArNmBwdhqhgBYK9XTnVQfQbLG7qNeOj53ZyBxkG+boj3N8T8ZEBCPf3RLi/B8L8PNHfw9nwvOzsbERFBYrxrRBJgsWLu6ysDM888wyqq6shk8lw33334fe//z3q6uqwatUqlJSUICQkBJs3b4a3t7el49EN/Hr0nF/VhDzljUfPCZH+CPf3RNgvBR3q4w4nR05xEPWWxYvb0dERzz33HKKjo9HU1IR7770XU6dOxY4dOzB58mQkJycjJSUFKSkpWLt2raXj2b3ORs/5v/x8w9GznyfCA64fPRNR37N4cQcEBCAgoH1la09PT4SFhaGiogJpaWnYunUrACAxMREPP/wwi9vMcpWNyLpaf8PRc393J4T7e3YYPYf5e2AQR89EohF1jru4uBjZ2dmIiYlBdXW1odD9/f1RXV0tZjSbt/d8OR779BQE4f9Gz2F+HD0TSYFMEK5dY2ZZzc3NePjhh/HYY49h1qxZGDduHH766SfD4+PHj8fJkydv+BpnzpyBi4uLuaN2SqVSwdXVVZR9m+q3Wa/UarDquxKEejvj6en+GODlBLmD9Zy5IeVja82klBWQVl5zZY2Kiup0uygj7ra2Nixfvhxz5szBrFmzAAC+vr5QKpUICAiAUqmEj4+P0ddxcXHp8hszt/YzH8TZt6l+nbW+pQ1/3H0YHq7O+CR5KgZ4u4mc7npSPbbWTkpZAWnltXRWi09SCoKAF154AWFhYViyZIlhe0JCAlJTUwEAqampmDFjhqWj2TydXsCT206jpK4Vf39ojFWWNhEZZ/ER96lTp7Br1y5ERERg7ty5AIDVq1cjOTkZK1euxPbt2xEcHIzNmzdbOprNe3PvRRzKqcL6eaMwbojx/9EQkXWyeHGPGzcOly5d6vSxTz75xMJp7MeuMyX4x8F8PDhxEB6YOEjsOETUC7xy0g5UNWvxp29+xvgh/fHynGix4xBRL/FEXDvw0alqtOkFvLVgNG/ORGQD+LfYxh3Nq8aBgmY8FheOQb7uxn8DEVk9FrcNa9Pp8co35xHoKcfjt4aLHYeI+giL24ZtPXoFlyoakTzeF65OjmLHIaI+wuK2UcpGFd7+/jLiIvwxOZRTJES2hMVtg1RtOjz1v5lQa/V4ec4ILkRAZGNY3DZGpxew4vNMnCiswcb7YhDm7yl2JCLqYyxuGyIIAl5MPYe95yvw8t0jcE9MsNiRiMgMWNw25O3vL2PbiSI8ER+OxVOHih2HiMyExW0jthwtxLvpubh/XCienjVc7DhEZEYsbhuw+2wpXv7mPGaOCMQb80byw0giG8filrgfc6uw6oszGD/YB+8tioWcy4kR2Tz+LZewcyX1SN7yE8L9PfHP34/jRTZEdoLFLVGXKxqx+N8n0M/dGZ88MgHebk5iRyIiC+FtXSXmXEk9PjiYh//8XIZ+7s7YsnQCAhXSWJePiPoGi1sCBEHA0bxqfHAwD4dyquDlIsejceFYMnUIArxY2kT2hsVtxfR6AfsulOODA3nIKq6Hv5cLnrsjEg9MHASFK6dGiOwVi9sKqbU6pGaW4B8Z+civbMZgX3esnzcK88eE8ANIImJxW5MmtRbbjhfhw8P5qGhQIzpYgfcfiMUdIwfA0YHnZhNROxa3yARBwKWKRuzOKsOWo4VoUGkxOcwX/5MUg+k3+fFiGiK6DotbBMpGFQ7nVLX/yK2CslENmQyYPSIIj90ajtGh/cSOSERWjMVtAa0aHU4U1uDQ5Uoczq3CxfJGAEB/dydMu8kf04f5YXqEHwZ4u4mclIikgMVtBnq9gAtlDTiUU4XDuZU4WVALjU4PZ0cHjBvSH8/eHonpN/lhxAAFHDh3TUQmYnH3kdK6VhzOqcKh3Cr8mFuFmmYNACAyyAu/mzwY0yP8MWGID9yceVYIEfUOi7uHWtr0SMuuwKGcKhzKqUReZTMAwN/LBbdG+GPaTX6YNswPAbyqkYj6GIvbBE1qLT45UoiDlytxqrAGOqEQrk4OmDDUFwvHD8L0CD8MD/TimSBEZFYs7m5Sa3VI3vITjuRVIzpYgfnR3kicFImxg/vzohgisigWdzfo9QKe/uosjuRV460FMbh37EBkZ2cjapif2NGIyA7xtq7dsP67bHybVYpnb4/EvWMHih2HiOwci9uIDw/l48PDBVg8ZQgeiwsTOw4REYv7RnadKcHre7Jx56ggrLt7BD90JCKrwOLuwpHcKjz9VRYmDvXBpvtG8yZPRGQ1WNydKKtvxRP/expD/TyQ8juu5UhE1oXF/RtanR4rPj8DtVaPDx4ay7Ucicjq8HTA33g3PRcnCmqw6b4YhPt7ih2HiOg6HHH/ypHcKryXnoN7xwzE/DE87Y+IrBOL+xdVTWqs+OIMhvp54LW50WLHISLqEqdK0H5l5Oovs1Df2oYtj0yAhwsPCxFZL464AaQcykfG5Uq8dPcIRA1QiB2HiOiG7L64T12pxca9l3DnqCA8OHGQ2HGIiIyy6+Kub23D8m2ZCPJ2xYb5N/PKSCKSBLuezP3b/lyU1rdixx+n8HxtIpIMux1xl9W34uMjhZgXG4LYQf3FjkNE1G12W9zv/JADQQBW3RYhdhQiIpPYZXHnKpvw5U9X8eCkQQj1cRc7DhGRSeyyuN/adwluTo54Mn6Y2FGIiExmd8V9trgO/zlXjj/cEgZfTxex4xARmczuirtZrcO4wf2xbDpXsyEiabK70wEnh/ti+x+niB2DiKjH7G7ETUQkdVZV3BkZGZg9ezZmzpyJlJQUseMQEVklqylunU6H1157DR9++CH27NmD3bt3Izc3V+xYRERWx2qK++zZsxg8eDBCQ0Ph7OyMu+66C2lpaWLHIiKyOlbz4WRFRQWCgoIMXwcGBuLs2bM3/D1qtRrZ2dnmjtYplUol2r5NJaWsgLTyMqv5SCmvubJGRUV1ut1qirsnXFxcuvzGzC07O1u0fZtKSlkBaeVlVvORUl5LZ7WaqZLAwECUl5cbvq6oqEBgYKCIiYiIrJPVFPeoUaNQWFiIq1evQqPRYM+ePUhISBA7FhGR1bGaqRK5XI6XXnoJy5Ytg06nw7333oubbrpJ7FhERFbHaoobAOLi4hAXFyd2DCIiq2Y1UyVERNQ9LG4iIolhcRMRSYxMEARB7BA9debMGbi48J7aRGSb5HJ5pydpSLq4iYjsEadKiIgkhsVNRCQxLG4iIolhcRMRSQyLm4hIYljcREQSY1X3KrE2arUaDz74IDQaDXQ6HWbPno3ly5d3eI5Go8EzzzyD8+fPo1+/fnj77bcxcOBAq8y6Y8cOvPnmm4bb5T700ENYsGCBxbNec+1mYoGBgfjHP/7R4TFrOa7X3CirtR3XhIQEeHh4wMHBAY6OjtixY0eHxwVBwBtvvIGDBw/C1dUVf/nLXxAdHS1SWuN5jx8/jscff9zw/s+cORNPPvmkGFHR0NCAF198EZcvX4ZMJsP69esRGxtreNxix1agLun1eqGpqUkQBEHQaDRCUlKSkJmZ2eE5n376qbBu3TpBEARh9+7dwooVKyyeUxC6l/Xrr78WXn31VTHidepf//qXsHr1aiE5Ofm6x6zluF5zo6zWdlzj4+OF6urqLh8/cOCAsHTpUkGv1wuZmZlCUlKSBdNdz1jeY8eOdXrcxfDMM88IX375pSAIgqBWq4X6+voOj1vq2HKq5AZkMhk8PDwAAFqtFlqtFjKZrMNz0tPTMW/ePADA7NmzcfToUQgiXNPUnazWpLy8HAcOHEBSUlKnj1vLcQWMZ5WatLQ0JCYmQiaTYfTo0WhoaIBSqRQ7ltVrbGzEyZMnDX8OnJ2doVAoOjzHUseWxW2ETqfD3LlzMWXKFEyZMgUxMTEdHq+oqMCAAQMAtF+e6uXlhdraWjGiGs0KAPv27cOcOXOwfPlylJWViZCy3fr167F27Vo4OHT+R9CajquxrID1HNdrli5divnz5+OLL7647rHfru8aFBSEiooKS8a7zo3yAu23t7jnnnuwbNky5OTkWDhdu+LiYvj4+OD5559HYmIiXnjhBbS0tHR4jqWOLYvbCEdHR+zatQsHDx7E2bNncfnyZbEjdclY1vj4eKSnp+Pbb7/FlClT8Oyzz4qSc//+/fDx8cHIkSNF2b8pupPVWo7rNdu2bcPOnTvxz3/+E5999hlOnjwpah5jjOWNjo5Geno6vvnmGzz88MN44oknRMmp1Wpx4cIFLFq0CKmpqXBzc0NKSoooWVjc3aRQKDBx4kQcOnSow/bAwEDDCEur1aKxsRH9+/cXI6JBV1n79+8PZ2dnAMCCBQtw/vx5MeLh9OnTSE9PR0JCAlavXo1jx47h6aef7vAcazmu3clqLcf1mmsfkvr6+mLmzJk4e/bsdY//en3X8vJyUdd3NZbX09PTMA0YFxcHrVaLmpoai+cMCgpCUFCQ4X+yt99+Oy5cuNDhOZY6tizuG6ipqUFDQwMAQKVS4ciRIwgLC+vwnISEBOzcuRMAsHfvXkyaNEmUueXuZP31XFt6ejrCw8MtmvGaNWvWICMjA+np6di0aRMmTZqEjRs3dniOtRzX7mS1luMKAC0tLWhqajL8+scff7zu7nIJCQlITU2FIAg4c+YMvLy8EBAQIEbcbuWtrKw0fL5x9uxZ6PV6Uf4R9/f3R1BQEPLz8wEAR48eve69ttSx5emAN6BUKvHcc89Bp9NBEATcfvvtiI+PxzvvvIORI0dixowZSEpKwtq1azFz5kx4e3vj7bffttqsW7duRXp6OhwdHeHt7Y0NGzaIkrUr1nhcu2Ktx7W6utowlaDT6XD33XfjlltuwbZt2wAAixYtQlxcHA4ePIiZM2fCzc0N69evt+q8e/fuxbZt2+Do6AhXV1ds2rRJtA/e161bh6effhptbW0IDQ3Fhg0bRDm2vK0rEZHEcKqEiEhiWNxERBLD4iYikhgWNxGRxLC4iYgkhqcDkt2rra3F4sWLAQBVVVVwcHCAj48PAODixYuIjIyETqdDWFgY/vrXv8LNzQ3Dhw/HnDlzDOd0a7VaTJs2DTExMdfdPZCor7G4ye71798fu3btAgC89957cHd3x9KlSwEAsbGxhsfWrFmDzz//HEuWLIG7uztycnKgUqng6uqKH3/8UdSrD8m+cKqEqJvGjRuHK1euGL6Oi4vDgQMHAAB79uzBXXfdJVIysjcsbqJu0Gq1yMjIQEREhGHbnXfeie+++w5qtRqXLl3q9G6MRObAqRKiG1CpVJg7dy6A9hH3r+/JHRkZieLiYuzevRtxcXFiRSQ7xOImugFXV1fDHHdnEhIS8Oabb2LLli2oq6uzYDKyZyxuol5ISkqCQqHA8OHDcfz4cbHjkJ3gHDdRLwQFBeF3v/ud2DHIzvDugEREEsMRNxGRxLC4iYgkhsVNRCQxLG4iIolhcRMRSQyLm4hIYljcREQS8/8BWCKh03+vSX8AAAAASUVORK5CYII="
>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's look at the percentiles for our test sample</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">percentiles</span><span class="p">[[</span><span class="n">test_sample_id</span><span class="p">]]</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TCGA-3X-AAV9-01</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>ENSG00000242268.2</th>
      <td>46.0</td>
    </tr>
    <tr>
      <th>ENSG00000259041.1</th>
      <td>51.0</td>
    </tr>
    <tr>
      <th>ENSG00000270112.3</th>
      <td>44.0</td>
    </tr>
    <tr>
      <th>ENSG00000167578.16</th>
      <td>69.0</td>
    </tr>
    <tr>
      <th>ENSG00000278814.1</th>
      <td>51.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>ENSG00000273233.1</th>
      <td>23.0</td>
    </tr>
    <tr>
      <th>ENSG00000105063.18</th>
      <td>56.0</td>
    </tr>
    <tr>
      <th>ENSG00000231119.2</th>
      <td>92.0</td>
    </tr>
    <tr>
      <th>ENSG00000280861.1</th>
      <td>51.0</td>
    </tr>
    <tr>
      <th>ENSG00000181518.3</th>
      <td>51.0</td>
    </tr>
  </tbody>
</table>
<p>60498 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can select the highest and lowest percentiles as a way to look for possible outliers (arbitrarily selecting 95 and 5 as thresholds).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">percentiles</span><span class="p">[[</span><span class="n">test_sample_id</span><span class="p">]][(</span><span class="n">percentiles</span><span class="p">[</span><span class="n">test_sample_id</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">95</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">percentiles</span><span class="p">[</span><span class="n">test_sample_id</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)]</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TCGA-3X-AAV9-01</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>ENSG00000280143.1</th>
      <td>98.0</td>
    </tr>
    <tr>
      <th>ENSG00000232001.1</th>
      <td>98.0</td>
    </tr>
    <tr>
      <th>ENSG00000206072.12</th>
      <td>100.0</td>
    </tr>
    <tr>
      <th>ENSG00000254102.1</th>
      <td>100.0</td>
    </tr>
    <tr>
      <th>ENSG00000165312.6</th>
      <td>100.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>ENSG00000103241.6</th>
      <td>100.0</td>
    </tr>
    <tr>
      <th>ENSG00000237803.5</th>
      <td>100.0</td>
    </tr>
    <tr>
      <th>ENSG00000270987.1</th>
      <td>98.0</td>
    </tr>
    <tr>
      <th>ENSG00000186115.12</th>
      <td>4.0</td>
    </tr>
    <tr>
      <th>ENSG00000123685.8</th>
      <td>96.0</td>
    </tr>
  </tbody>
</table>
<p>3530 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="calculating-kiqr">Calculating kIQR<a class="headerlink" href="#calculating-kiqr" title="Permanent link">&para;</a></h3>
<p>The next metric we are going to look at is the kIQR. This metric is different from percentile in that it takes into account the spread or variance of the distribution. To be able to calculate this we first need to calculate some parameters for each gene</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">quantiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
  <span class="n">chol_matrix</span><span class="p">[</span><span class="n">test_sample_id</span><span class="p">],</span> 
  <span class="n">chol_matrix</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
  <span class="n">chol_matrix</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
  <span class="n">chol_matrix</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mf">0.25</span><span class="p">:</span> <span class="s1">&#39;q1&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">:</span> <span class="s1">&#39;q3&#39;</span><span class="p">,</span> <span class="n">test_sample_id</span><span class="p">:</span> <span class="s1">&#39;tpm&#39;</span><span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">quantiles</span><span class="p">[</span><span class="s1">&#39;iqr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">q3</span> <span class="o">-</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">q1</span>
<span class="n">quantiles</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>tpm</th>
      <th>q1</th>
      <th>q2</th>
      <th>q3</th>
      <th>iqr</th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>0</th>
      <td>ENSG00000242268.2</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ENSG00000259041.1</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ENSG00000270112.3</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ENSG00000167578.16</td>
      <td>4.8905</td>
      <td>4.0046</td>
      <td>4.6525</td>
      <td>5.0104</td>
      <td>1.0058</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ENSG00000278814.1</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>60493</th>
      <td>ENSG00000273233.1</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-3.4580</td>
      <td>-3.0469</td>
      <td>6.9189</td>
    </tr>
    <tr>
      <th>60494</th>
      <td>ENSG00000105063.18</td>
      <td>5.0352</td>
      <td>4.6713</td>
      <td>4.9978</td>
      <td>5.2327</td>
      <td>0.5614</td>
    </tr>
    <tr>
      <th>60495</th>
      <td>ENSG00000231119.2</td>
      <td>-2.4659</td>
      <td>-4.6082</td>
      <td>-3.8160</td>
      <td>-3.1714</td>
      <td>1.4368</td>
    </tr>
    <tr>
      <th>60496</th>
      <td>ENSG00000280861.1</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>60497</th>
      <td>ENSG00000181518.3</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
    </tr>
  </tbody>
</table>
<p>60498 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we are ready to calculate the kIQR for our sample</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">quantiles</span><span class="p">[</span><span class="s1">&#39;kiqr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantiles</span><span class="p">[</span><span class="n">quantiles</span><span class="o">.</span><span class="n">iqr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">tpm</span> <span class="o">-</span> <span class="n">row</span><span class="o">.</span><span class="n">q2</span><span class="p">)</span> <span class="o">/</span> <span class="n">row</span><span class="o">.</span><span class="n">iqr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on the newly calcuated kIQR we pick thresholds to select outliers. We can do these alone or with the percentile filters. We have arbitrarily chosen 3 for the purposes of this tutorial</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">quantile_outliers</span> <span class="o">=</span> <span class="n">quantiles</span><span class="p">[(</span><span class="n">quantiles</span><span class="o">.</span><span class="n">kiqr</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">quantiles</span><span class="o">.</span><span class="n">kiqr</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">3</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">quantile_outliers</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>gene</th>
      <th>tpm</th>
      <th>q1</th>
      <th>q2</th>
      <th>q3</th>
      <th>iqr</th>
      <th>kiqr</th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>0</th>
      <td>245</td>
      <td>ENSG00000259677.1</td>
      <td>-9.9658</td>
      <td>-4.6082</td>
      <td>-3.6259</td>
      <td>-2.8262</td>
      <td>1.7820</td>
      <td>-3.557744</td>
    </tr>
    <tr>
      <th>1</th>
      <td>481</td>
      <td>ENSG00000223922.1</td>
      <td>-9.9658</td>
      <td>-4.2934</td>
      <td>-3.4580</td>
      <td>-2.3147</td>
      <td>1.9787</td>
      <td>-3.288927</td>
    </tr>
    <tr>
      <th>2</th>
      <td>598</td>
      <td>ENSG00000255236.2</td>
      <td>-9.9658</td>
      <td>-3.3076</td>
      <td>-2.1140</td>
      <td>-1.3921</td>
      <td>1.9155</td>
      <td>-4.099086</td>
    </tr>
    <tr>
      <th>3</th>
      <td>652</td>
      <td>ENSG00000057149.14</td>
      <td>4.7464</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-5.5735</td>
      <td>4.3923</td>
      <td>3.349544</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1159</td>
      <td>ENSG00000271916.1</td>
      <td>-9.9658</td>
      <td>-2.2447</td>
      <td>-0.4719</td>
      <td>0.4125</td>
      <td>2.6572</td>
      <td>-3.572896</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>121</th>
      <td>58758</td>
      <td>ENSG00000253492.1</td>
      <td>-9.9658</td>
      <td>-0.5756</td>
      <td>1.7702</td>
      <td>2.6161</td>
      <td>3.1917</td>
      <td>-3.677037</td>
    </tr>
    <tr>
      <th>122</th>
      <td>58852</td>
      <td>ENSG00000169562.9</td>
      <td>4.1612</td>
      <td>6.8178</td>
      <td>7.3061</td>
      <td>7.6176</td>
      <td>0.7998</td>
      <td>-3.932108</td>
    </tr>
    <tr>
      <th>123</th>
      <td>59675</td>
      <td>ENSG00000270617.1</td>
      <td>-9.9658</td>
      <td>-2.9324</td>
      <td>-2.4659</td>
      <td>-0.7834</td>
      <td>2.1490</td>
      <td>-3.489949</td>
    </tr>
    <tr>
      <th>124</th>
      <td>59884</td>
      <td>ENSG00000235298.1</td>
      <td>-9.9658</td>
      <td>-1.0862</td>
      <td>-0.3201</td>
      <td>0.6239</td>
      <td>1.7101</td>
      <td>-5.640430</td>
    </tr>
    <tr>
      <th>125</th>
      <td>59912</td>
      <td>ENSG00000070526.14</td>
      <td>4.1252</td>
      <td>-2.7274</td>
      <td>-1.8314</td>
      <td>-1.0262</td>
      <td>1.7012</td>
      <td>3.501411</td>
    </tr>
  </tbody>
</table>
<p>126 rows × 8 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we pick some of these genes to plot</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">outlier_gene</span> <span class="o">=</span> <span class="n">quantile_outliers</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gene</span> 
<span class="n">outlier_gene</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>&#39;ENSG00000259677.1&#39;</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And create a histogram which highlights where the current sample lands relative to the other samples</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">chol_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">outlier_gene</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">outlier_gene</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;TPM&#39;</span><span class="p">)</span>

<span class="c1"># add a marker over the bin the sample lands in</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">quantile_outliers</span><span class="p">[</span><span class="n">quantile_outliers</span><span class="o">.</span><span class="n">gene</span> <span class="o">==</span> <span class="n">outlier_gene</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tpm</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">current</span> <span class="o">&gt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="ow">and</span> <span class="n">current</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">():</span>
      <span class="n">p</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
          <span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
          <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">(),</span>
          <span class="s1">&#39;*&#39;</span><span class="p">,</span>
          <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
          <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
      <span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="creating-the-report-input">Creating the Report Input<a class="headerlink" href="#creating-the-report-input" title="Permanent link">&para;</a></h2>
<p>Since the required input to the IPR python adapter is JSON we will format the output from this analysis to match that specification. Note this will only contain the expression relevant portions.</p>
<p>We will start by combining the percentile, tpm, and kiqr into a single matrix</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
  <span class="n">quantiles</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;gene&#39;</span><span class="p">),</span> 
  <span class="n">percentiles</span><span class="p">[[</span><span class="n">test_sample_id</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">test_sample_id</span><span class="p">:</span> <span class="s1">&#39;percentile&#39;</span><span class="p">})</span>
<span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">metrics_df</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tpm</th>
      <th>q1</th>
      <th>q2</th>
      <th>q3</th>
      <th>iqr</th>
      <th>kiqr</th>
      <th>percentile</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>ENSG00000242268.2</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>ENSG00000259041.1</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>ENSG00000270112.3</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>ENSG00000167578.16</th>
      <td>4.8905</td>
      <td>4.0046</td>
      <td>4.6525</td>
      <td>5.0104</td>
      <td>1.0058</td>
      <td>0.236628</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>ENSG00000278814.1</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>ENSG00000273233.1</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-3.4580</td>
      <td>-3.0469</td>
      <td>6.9189</td>
      <td>-0.940583</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>ENSG00000105063.18</th>
      <td>5.0352</td>
      <td>4.6713</td>
      <td>4.9978</td>
      <td>5.2327</td>
      <td>0.5614</td>
      <td>0.066619</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>ENSG00000231119.2</th>
      <td>-2.4659</td>
      <td>-4.6082</td>
      <td>-3.8160</td>
      <td>-3.1714</td>
      <td>1.4368</td>
      <td>0.939658</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>ENSG00000280861.1</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>ENSG00000181518.3</th>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>0.0000</td>
      <td>NaN</td>
      <td>51.0</td>
    </tr>
  </tbody>
</table>
<p>60498 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we are going to use our thresholds to assign labels</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">percentile_threshold</span> <span class="o">=</span> <span class="mf">97.5</span>
<span class="n">kiqr_threshold</span> <span class="o">=</span> <span class="mf">2.5</span>


<span class="n">metrics_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metrics_df</span><span class="o">.</span><span class="n">percentile</span> <span class="o">&gt;=</span> <span class="n">percentile_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metrics_df</span><span class="o">.</span><span class="n">kiqr</span> <span class="o">&gt;=</span> <span class="n">kiqr_threshold</span><span class="p">),</span> <span class="s1">&#39;kbCategory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;increased expression&#39;</span>
<span class="n">metrics_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">metrics_df</span><span class="o">.</span><span class="n">percentile</span> <span class="o">&lt;=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">percentile_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">metrics_df</span><span class="o">.</span><span class="n">kiqr</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kiqr_threshold</span><span class="p">),</span> <span class="s1">&#39;kbCategory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;reduced expression&#39;</span>

<span class="n">metrics_df</span><span class="p">[</span><span class="o">~</span><span class="n">metrics_df</span><span class="o">.</span><span class="n">kbCategory</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tpm</th>
      <th>q1</th>
      <th>q2</th>
      <th>q3</th>
      <th>iqr</th>
      <th>kiqr</th>
      <th>percentile</th>
      <th>kbCategory</th>
    </tr>
    <tr>
      <th>gene</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
<tbody>
    <tr>
      <th>ENSG00000057149.14</th>
      <td>4.7464</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-5.5735</td>
      <td>4.3923</td>
      <td>3.349544</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000140522.11</th>
      <td>0.0580</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.897554</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000089116.3</th>
      <td>-0.0277</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.872781</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000087495.16</th>
      <td>4.8095</td>
      <td>-3.0469</td>
      <td>-2.0529</td>
      <td>-0.4325</td>
      <td>2.6144</td>
      <td>2.624847</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000272702.1</th>
      <td>-6.5064</td>
      <td>-2.5479</td>
      <td>-1.5951</td>
      <td>-1.1488</td>
      <td>1.3991</td>
      <td>-3.510328</td>
      <td>2.0</td>
      <td>reduced expression</td>
    </tr>
    <tr>
      <th>ENSG00000254231.1</th>
      <td>-2.2447</td>
      <td>0.5955</td>
      <td>1.2756</td>
      <td>1.9527</td>
      <td>1.3572</td>
      <td>-2.593796</td>
      <td>2.0</td>
      <td>reduced expression</td>
    </tr>
    <tr>
      <th>ENSG00000073282.12</th>
      <td>1.4652</td>
      <td>-4.2934</td>
      <td>-3.6259</td>
      <td>-2.3884</td>
      <td>1.9050</td>
      <td>2.672493</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000142700.11</th>
      <td>0.3796</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.990519</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000077616.10</th>
      <td>1.1641</td>
      <td>-2.6349</td>
      <td>-2.1779</td>
      <td>-1.4699</td>
      <td>1.1650</td>
      <td>2.868670</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000227392.1</th>
      <td>-9.9658</td>
      <td>-1.3183</td>
      <td>-0.2159</td>
      <td>0.5568</td>
      <td>1.8751</td>
      <td>-5.199669</td>
      <td>2.0</td>
      <td>reduced expression</td>
    </tr>
    <tr>
      <th>ENSG00000147689.16</th>
      <td>5.2694</td>
      <td>-6.5064</td>
      <td>-5.5735</td>
      <td>-3.1714</td>
      <td>3.3350</td>
      <td>3.251244</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000174332.5</th>
      <td>1.3846</td>
      <td>-5.0116</td>
      <td>-4.2934</td>
      <td>-3.3076</td>
      <td>1.7040</td>
      <td>3.332160</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000163207.6</th>
      <td>2.4008</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>3.574782</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000158786.4</th>
      <td>-0.6643</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.688761</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000261857.6</th>
      <td>7.6963</td>
      <td>-2.7274</td>
      <td>-1.2481</td>
      <td>-0.2845</td>
      <td>2.4429</td>
      <td>3.661386</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000265179.6</th>
      <td>-0.4325</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.755767</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000198910.12</th>
      <td>5.3948</td>
      <td>-3.4580</td>
      <td>-1.8836</td>
      <td>-0.9406</td>
      <td>2.5174</td>
      <td>2.891237</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000196154.11</th>
      <td>11.1159</td>
      <td>5.3827</td>
      <td>6.2565</td>
      <td>7.3173</td>
      <td>1.9346</td>
      <td>2.511837</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000148704.12</th>
      <td>-0.1828</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.827947</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000171956.6</th>
      <td>-0.2159</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.818379</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000228630.5</th>
      <td>0.9568</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>3.157368</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000132361.16</th>
      <td>3.7825</td>
      <td>5.2987</td>
      <td>5.4922</td>
      <td>5.7616</td>
      <td>0.4629</td>
      <td>-3.693454</td>
      <td>2.0</td>
      <td>reduced expression</td>
    </tr>
    <tr>
      <th>ENSG00000113430.9</th>
      <td>-0.1993</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.823177</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000166869.2</th>
      <td>-0.1504</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.837313</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000198488.10</th>
      <td>0.4967</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>3.024368</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000101470.9</th>
      <td>2.6510</td>
      <td>-2.5479</td>
      <td>-1.8836</td>
      <td>-1.3183</td>
      <td>1.2296</td>
      <td>3.687866</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000099958.14</th>
      <td>7.1647</td>
      <td>1.5563</td>
      <td>2.5238</td>
      <td>3.2002</td>
      <td>1.6439</td>
      <td>2.823104</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000125820.5</th>
      <td>2.4805</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>3.597820</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000215115.6</th>
      <td>0.7664</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>3.102330</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000130035.6</th>
      <td>1.9931</td>
      <td>-4.0350</td>
      <td>-3.4580</td>
      <td>-2.3884</td>
      <td>1.6466</td>
      <td>3.310519</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000101160.13</th>
      <td>8.6516</td>
      <td>7.4139</td>
      <td>7.6005</td>
      <td>7.8323</td>
      <td>0.4184</td>
      <td>2.512189</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000204930.9</th>
      <td>-3.8160</td>
      <td>-6.5064</td>
      <td>-6.5064</td>
      <td>-5.5735</td>
      <td>0.9329</td>
      <td>2.883910</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000215113.6</th>
      <td>0.7664</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>3.102330</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000175928.5</th>
      <td>3.2796</td>
      <td>-2.8262</td>
      <td>-1.9379</td>
      <td>-0.7588</td>
      <td>2.0674</td>
      <td>2.523701</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000186081.11</th>
      <td>6.5720</td>
      <td>-3.6259</td>
      <td>-2.3884</td>
      <td>-0.1828</td>
      <td>3.4431</td>
      <td>2.602422</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000181690.7</th>
      <td>0.9789</td>
      <td>-4.0350</td>
      <td>-3.3076</td>
      <td>-2.6349</td>
      <td>1.4001</td>
      <td>3.061567</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000182103.4</th>
      <td>-1.4305</td>
      <td>-6.5064</td>
      <td>-6.5064</td>
      <td>-5.0116</td>
      <td>1.4948</td>
      <td>3.395705</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000271474.1</th>
      <td>-0.9686</td>
      <td>-4.6082</td>
      <td>-3.8160</td>
      <td>-3.6259</td>
      <td>0.9823</td>
      <td>2.898707</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000169962.4</th>
      <td>1.3109</td>
      <td>-2.7274</td>
      <td>-2.1140</td>
      <td>-1.4305</td>
      <td>1.2969</td>
      <td>2.640836</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000166105.15</th>
      <td>-1.0262</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.584148</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000143199.17</th>
      <td>-6.5064</td>
      <td>-1.6850</td>
      <td>-0.4521</td>
      <td>0.5763</td>
      <td>2.2613</td>
      <td>-2.677354</td>
      <td>2.0</td>
      <td>reduced expression</td>
    </tr>
    <tr>
      <th>ENSG00000180616.8</th>
      <td>0.9191</td>
      <td>-2.6349</td>
      <td>-2.1140</td>
      <td>-1.4305</td>
      <td>1.2044</td>
      <td>2.518349</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000230587.1</th>
      <td>0.0990</td>
      <td>-3.6259</td>
      <td>-3.1714</td>
      <td>-2.4659</td>
      <td>1.1600</td>
      <td>2.819310</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000256162.2</th>
      <td>-9.9658</td>
      <td>-1.0559</td>
      <td>0.6880</td>
      <td>3.1604</td>
      <td>4.2163</td>
      <td>-2.526813</td>
      <td>2.0</td>
      <td>reduced expression</td>
    </tr>
    <tr>
      <th>ENSG00000205209.7</th>
      <td>-6.5064</td>
      <td>-3.4580</td>
      <td>-2.5479</td>
      <td>-1.9942</td>
      <td>1.4638</td>
      <td>-2.704263</td>
      <td>2.0</td>
      <td>reduced expression</td>
    </tr>
    <tr>
      <th>ENSG00000204542.2</th>
      <td>3.6382</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-4.6082</td>
      <td>5.3576</td>
      <td>2.539197</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000166961.14</th>
      <td>2.4359</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-5.5735</td>
      <td>4.3923</td>
      <td>2.823509</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000102096.9</th>
      <td>5.7455</td>
      <td>2.5112</td>
      <td>3.0393</td>
      <td>3.5657</td>
      <td>1.0545</td>
      <td>2.566335</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000124191.17</th>
      <td>5.1023</td>
      <td>0.2522</td>
      <td>0.9568</td>
      <td>1.4911</td>
      <td>1.2389</td>
      <td>3.346113</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000107485.15</th>
      <td>3.9175</td>
      <td>-1.9379</td>
      <td>-1.3921</td>
      <td>0.0014</td>
      <td>1.9393</td>
      <td>2.737895</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000065618.16</th>
      <td>5.4741</td>
      <td>-4.6082</td>
      <td>-2.9324</td>
      <td>-1.4699</td>
      <td>3.1383</td>
      <td>2.678680</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000158816.15</th>
      <td>-0.1828</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-6.5064</td>
      <td>3.4594</td>
      <td>2.827947</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000135374.9</th>
      <td>3.6077</td>
      <td>-9.9658</td>
      <td>-9.9658</td>
      <td>-5.5735</td>
      <td>4.3923</td>
      <td>3.090294</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000145113.21</th>
      <td>5.3618</td>
      <td>-2.5479</td>
      <td>-1.9942</td>
      <td>-1.0262</td>
      <td>1.5217</td>
      <td>4.834067</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000162367.11</th>
      <td>2.7847</td>
      <td>-1.5522</td>
      <td>-1.0559</td>
      <td>-0.2328</td>
      <td>1.3194</td>
      <td>2.910869</td>
      <td>100.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000105371.8</th>
      <td>1.3735</td>
      <td>-3.8160</td>
      <td>-3.0469</td>
      <td>-2.0529</td>
      <td>1.7631</td>
      <td>2.507175</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
    <tr>
      <th>ENSG00000070526.14</th>
      <td>4.1252</td>
      <td>-2.7274</td>
      <td>-1.8314</td>
      <td>-1.0262</td>
      <td>1.7012</td>
      <td>3.501411</td>
      <td>98.0</td>
      <td>increased expression</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally we can use this to create our output. The percentiles and kIQR values we have calculated above were for our disease comparator but a similar process would be used for normal and biopsy comparators</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">metrics_df</span> <span class="o">=</span> <span class="n">metrics_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;kiqr&#39;</span><span class="p">:</span> <span class="s1">&#39;diseasekIQR&#39;</span><span class="p">,</span> <span class="s1">&#39;percentile&#39;</span><span class="p">:</span> <span class="s1">&#39;diseasePercentile&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We often leave non-variant expression records in to supplement the copy variant and structural variant information. For these records the kbCategory field is a null value since they are not an expression outlier</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">expression_variants</span> <span class="o">=</span> <span class="n">metrics_df</span><span class="p">[[</span><span class="s1">&#39;tpm&#39;</span><span class="p">,</span> <span class="s1">&#39;diseasekIQR&#39;</span><span class="p">,</span> <span class="s1">&#39;diseasePercentile&#39;</span><span class="p">,</span> <span class="s1">&#39;gene&#39;</span><span class="p">,</span> <span class="s1">&#39;kbCategory&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
<span class="n">expression_variants</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>{&#39;diseasePercentile&#39;: 46.0,
 &#39;diseasekIQR&#39;: None,
 &#39;gene&#39;: &#39;ENSG00000242268.2&#39;,
 &#39;kbCategory&#39;: None,
 &#39;tpm&#39;: -9.9658}</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will also add the disease comparator information to the JSON</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">output_json</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;comparators&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;analysisRole&#39;</span><span class="p">:</span> <span class="s1">&#39;expression (disease)&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TCGA CHOL&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">chol_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="s1">&#39;expressionVariants&#39;</span><span class="p">:</span> <span class="n">expression_variants</span>
<span class="p">}</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;result.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
  <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">output_json</span><span class="p">,</span> <span class="n">fh</span><span class="p">)</span>
</code></pre></div>

</div>
</div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../templates/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Templates" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Templates
            </div>
          </div>
        </a>
      
      
        
        <a href="../RNA_Expression_Similarity/" class="md-footer__link md-footer__link--next" aria-label="Next: RNA Expression Similarity" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              RNA Expression Similarity
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.top", "navigation.sections", "navigation.instant", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.960e086b.min.js"></script>
      
        <script src="../../../js/mathjax.config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>